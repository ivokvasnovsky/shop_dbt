WITH STORES_LIST AS (
    SELECT DISTINCT STORE_NAME
    FROM {{ ref('stg_customer_support') }}
    WHERE STORE_NAME IS NULL
    UNION
    SELECT DISTINCT STORE_NAME
    FROM {{ ref('stg_inventory') }}
    WHERE STORE_NAME IS NULL
    UNION
    SELECT DISTINCT STORE_NAME
    FROM {{ ref('stg_sales') }}
    WHERE STORE_NAME IS NULL
)

SELECT
    STORE_NAME AS STORE_NAME_FULL,
    CAST(REGEXP_REPLACE(STORE_NAME, '[^0-9]', '', 'g') AS INTEGER)
        AS STORE_NUMBER
FROM STORES_LIST
ORDER BY STORE_NUMBER
